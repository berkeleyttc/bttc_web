<!DOCTYPE html>
<html lang="en" class="no-js" xmlns="http://www.w3.org/1999/xhtml">

<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <title>Berkeley Table Tennis Club</title>
  <meta name="description" content="The Berkeley Table Tennis Club is a fun, friendly group of people in the San Francisco Bay Area. Come out and play!" />
  <meta name="author" content="Adam Traver" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <link rel="shortcut icon" href="/favicon.ico" />
  <link rel="apple-touch-icon" href="/apple-touch-icon.png" />
  <link rel="stylesheet" href="https://www.google.com/cse/api/overlay.css" type="text/css" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lobster|PT+Sans+Narrow:400,700" type="text/css" />
  <link rel="stylesheet" href="css/style.css?v=1" type="text/css" />
  <link rel="stylesheet" href="css/handheld.css?v=1" media="handheld" type="text/css" />
  <script src="js/modernizr-1.5.min.js" type="text/javascript"></script>
  <script src="https://www.google.com/jsapi" type="text/javascript"></script>
</head>
<body>
  <div id="container">
    <div id="header">
      <div class="container_12 clearfix">
        <div id="logo" class="grid_6">
          <a href="index.html" title="Go Home">
            <img src="images/logo.gif" height="60" alt="BTTC Logo" border="0" />
          </a>
        </div>
        <div id="search" class="grid_6"></div>
      </div>
      <div class="border">
        <ul id="nav" class="container_12 clearfix">
          <li class="grid_2"><a href="index.html" title="Home">Home</a></li>
          <li class="grid_2"><a href="results.html" title="Weekly Results">Results</a></li>
          <li class="grid_2"><a href="coaching.html" title="Coaching">Coaching</a></li>
          <li class="grid_2"><a href="about.html" title="About Us">About Us</a></li>
          <li class="grid_2"><a href="club_policy.html" title="Club Policy">ClubPolicy</a></li>
          <li class="grid_2 last"><a href="more.html" title="More...">More...</a></li>
        </ul>
      </div>
    </div>
    <div class="border">
      <div id="main" class="container_12 clearfix results">
        <div class="grid_12" style="width: 940px; height: 132px">
          <h1>Weekly Round Robin Results</h1>
          <p>Every Friday evening, we host a round robin tournament. The tournament results have been published since 2005, although the tournament itself has been going on for more than 25 years. The results are posted below.</p>
        </div>

        <div class="grid_12">
          <label for="yearSelector"><strong>Select Year:</strong></label>
          <select id="yearSelector" onchange="fetchResults()">
            <option value="">Current Year</option>
            <option value="2025">2025</option>
            <option value="2024">2024</option>
            <option value="2023">2023</option>
            <option value="2022">2022</option>
          </select>
        </div>

        <h2 id="dynamic-year-header">&nbsp;</h2>
        <table width="100%">
          <thead>
            <tr>
              <th>January</th>
              <th>February</th>
              <th>March</th>
              <th>April</th>
              <th>May</th>
              <th>June</th>
              <th>July</th>
              <th>August</th>
              <th>September</th>
              <th>October</th>
              <th>November</th>
              <th>December</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="month-column" id="Jan"></td>
              <td class="month-column" id="Feb"></td>
              <td class="month-column" id="Mar"></td>
              <td class="month-column" id="Apr"></td>
              <td class="month-column" id="May"></td>
              <td class="month-column" id="Jun"></td>
              <td class="month-column" id="Jul"></td>
              <td class="month-column" id="Aug"></td>
              <td class="month-column" id="Sep"></td>
              <td class="month-column" id="Oct"></td>
              <td class="month-column" id="Nov"></td>
              <td class="month-column" id="Dec"></td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <script>
    const monthAbbr = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];

    function fetchResults() {
      const year = document.getElementById('yearSelector').value || new Date().getFullYear();
      const scriptUrl = 'https://script.google.com/macros/s/AKfycbzOAIbQPaUj66F_ZPI8myhR0mkfCxHdfHxtTMB8n74TP6u319IPAT-w1JdptfxBoJMUOQ/exec'; 

      document.getElementById('dynamic-year-header').innerHTML = `&nbsp; ${year}`;

      fetch(`${scriptUrl}?year=${year}`)
        .then(response => response.json())
        .then(data => {
          monthAbbr.forEach(month => {
            document.getElementById(month).innerHTML = '';
          });

          data.forEach(file => {
            const match = file.name.match(/\d{4}([A-Za-z]{3})(\d{2})/);
            if (match) {
              const month = match[1];
              const day = match[2];
              if (monthAbbr.includes(month)) {
                const cell = document.getElementById(month);
                const link = document.createElement('a');
                link.href = file.url;
                link.textContent = `${month} ${day}`;
                link.target = '_blank';
                cell.appendChild(link);
              }
            }
          });
        })
        .catch(error => console.error('Error fetching results:', error));
    }

    window.onload = fetchResults;
  </script>
</body>
</html>
